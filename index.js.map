{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PixabayApiKey = '30127977-afd00810882476e7ef9a8a757';\n\naxios.defaults.baseURL = `https://pixabay.com/api/?key=${PixabayApiKey}&image_type=photo&orientation=horizontal&safesearch=true`;\n\nexport const searchImages = async (query, perPage = 15, page = 1) => {\n  // const url = `${baseUrl}&q=${query}&per_page=${perPage}`;\n\n  // const response = fetch(url)\n  //   .then(res => res.json())\n  //   .catch(err => console.log(err));\n\n  const { data } = await axios(`&q=${query}&per_page=${perPage}&page=${page}`);\n\n  return data;\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryContainer = document.querySelector('.gallery');\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport const createGalaryMatkup = images => {\n  const galleryMarkup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        views,\n        likes,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li class=\"gallery-item-info\">\n                <p class=\"info-item-title\">\n                Likes\n                </p>\n                <p class=\"info-item-value\">\n                  ${likes}\n                </p>\n              </li>\n              <li class=\"gallery-item-info\">\n                <p class=\"info-item-title\">\n                  Views\n                </p>\n                <p class=\"info-item-value\">\n                  ${views}\n                </p>\n              </li>\n              <li class=\"gallery-item-info\">\n                <p class=\"info-item-title\">\n                  Comments\n                </p>\n                <p class=\"info-item-value\">\n                  ${comments}\n                </p>\n              </li>\n              <li class=\"gallery-item-info\">\n                <p class=\"info-item-title\">\n                  Downloads\n                </p>\n                <p class=\"info-item-value\">\n                  ${downloads}\n                </p>\n              </li>\n            </ul>\n          </a>\n        </li>\n      `;\n      }\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', galleryMarkup);\n  gallery.refresh();\n};\n\nexport const clearGalleryContainer = () => {\n  galleryContainer.innerHTML = '';\n};\n","import { searchImages } from './js/pixabay-api';\nimport {\n  createGalaryMatkup,\n  clearGalleryContainer,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.search-form');\nconst loader = document.querySelector('.loader-wrapper');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst endContent = document.querySelector('.end-content');\n\nconst url = new URL(window.location);\nconst searchParams = url.searchParams;\nlet query = searchParams.get('q');\nconst perPage = searchParams.get('per_page')\n  ? searchParams.get('per_page')\n  : 15;\nconst page = searchParams.get('page') ? searchParams.get('page') : 1;\n\nif (query) {\n  form.query.value = query;\n  fetchImage(query, perPage, page);\n} else {\n  form.query.value = '';\n}\n\nform.addEventListener('submit', evt => {\n  evt.preventDefault();\n\n  loadMoreBtn.classList.add('hidden');\n\n  const formData = new FormData(form);\n  const formQuery = formData.get('query').trim();\n\n  if (formQuery === query) {\n    return;\n  }\n\n  if (formQuery.length < 1) {\n    iziToast.error({\n      title: 'Error',\n      position: 'topRight',\n      message: 'Query field cannot be empty!',\n    });\n    return;\n  }\n\n  if (formQuery !== query) {\n    clearGalleryContainer();\n    url.searchParams.delete('page');\n  }\n\n  url.searchParams.set('q', formQuery);\n  url.searchParams.set('per_page', perPage);\n  window.history.pushState({}, '', url);\n  query = formQuery;\n\n  fetchImage(formQuery, perPage);\n});\n\nloadMoreBtn.addEventListener('click', loadMore);\n\nasync function loadMore() {\n  const gallaryItem = document.querySelector('.gallery-item');\n\n  const { height: cardHeight } = gallaryItem.getBoundingClientRect();\n\n  const page = searchParams.get('page')\n    ? Number(searchParams.get('page')) + 1\n    : 2;\n\n  url.searchParams.set('page', page);\n  window.history.pushState({}, '', url);\n\n  await fetchImage(query, perPage, page);\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function fetchImage(query, perPage, page = 1) {\n  loader.classList.add('show');\n\n  try {\n    const data = await searchImages(query, perPage, page);\n\n    loader.classList.remove('show');\n\n    if (data.hits.length < 1) {\n      loadMoreBtn.classList.add('hidden');\n      iziToast.error({\n        title: 'Error',\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      loadMoreBtn.classList.remove('hidden');\n    }\n\n    if (page >= totalPages(data.totalHits, perPage)) {\n      loadMoreBtn.classList.add('hidden');\n      endContent.classList.remove('hidden');\n    } else {\n      endContent.classList.add('hidden');\n    }\n\n    createGalaryMatkup(data.hits);\n  } catch (err) {\n    loader.classList.remove('show');\n\n    iziToast.error({\n      title: 'Error',\n      position: 'topRight',\n      message: 'Failed to load images. Please try again!',\n    });\n  }\n}\n\nfunction totalPages(total, perPage) {\n  return Math.ceil(total / perPage);\n}\n"],"names":["PixabayApiKey","axios","searchImages","query","perPage","page","data","galleryContainer","gallery","SimpleLightbox","createGalaryMatkup","images","galleryMarkup","webformatURL","largeImageURL","tags","views","likes","comments","downloads","clearGalleryContainer","form","loader","loadMoreBtn","endContent","url","searchParams","fetchImage","evt","formQuery","iziToast","loadMore","gallaryItem","cardHeight","totalPages","total"],"mappings":"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"}